import { Table, Callout } from "nextra/components";

# API Errors

## Overview

When interacting with the Skala API, errors may occur due to **invalid requests**, **missing parameters**, or **server issues**. The API responds with **standard HTTP error codes**, along with a **detailed JSON error message** to help diagnose the issue.

- **Client Errors (4xx)**: Issues caused by incorrect requests (e.g., missing parameters, invalid authentication).
- **Server Errors (5xx)**: Issues caused by Skalaâ€™s servers.

---

## Attachment Processing Errors

If one or more **task attachments** contain invalid data, the **task callback** will be triggered with an **error response**, and the **task's status** will be set to `"error"`. Additional details about the failure will be stored in the **task response**.

---

## **Common API Error Codes**

<div style={{ marginTop: "1.5rem" }}>
  <Table>
    <thead>
      <Table.Tr>
        <Table.Th>Error Code</Table.Th>
        <Table.Th>Meaning</Table.Th>
      </Table.Tr>
    </thead>
    <tbody>
      <Table.Tr>
        <Table.Td>200</Table.Td>
        <Table.Td>OK â€” Everything worked as expected.</Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>400</Table.Td>
        <Table.Td>
          Bad Request â€” The request was **unacceptable**, often due to missing a
          **required parameter**.
        </Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>401</Table.Td>
        <Table.Td>Unauthorized â€” No valid API key provided.</Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>402</Table.Td>
        <Table.Td>
          Not Enabled â€” Please contact **sales@skalaapi.com** before creating
          this type of task.
        </Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>404</Table.Td>
        <Table.Td>
          Not Found â€” The requested resource **does not exist**.
        </Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>409</Table.Td>
        <Table.Td>
          Conflict â€” The provided **idempotency key** or **unique_id** is
          already in use for a different request.
        </Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>429</Table.Td>
        <Table.Td>
          Too Many Requests â€” API rate limit exceeded. Slow down request rate.
        </Table.Td>
      </Table.Tr>
      <Table.Tr>
        <Table.Td>500</Table.Td>
        <Table.Td>
          Internal Server Error â€” Skala had a server issue. Try again later.
        </Table.Td>
      </Table.Tr>
    </tbody>
  </Table>
</div>

---

## **Example API Error Formats**

Below are examples of **error responses** returned by the Skala API:

---

### **Missing Attachment Parameter**

ðŸ“Œ **Cause:** The request **did not include** an `attachment` or `attachments` parameter.

#### **400 Bad Request**

```json filename="JSON"
{
  "status_code": 400,
  "error": "Please include an attachment or attachments parameter."
}
```

ðŸ”¹ **Solution:**

- Ensure that **at least one attachment** is provided in the API request.
- Attachments should be included as a **valid URL** or a **list of URLs**.

---

### **Attachment Download Failed**

ðŸ“Œ **Cause:** Skala **could not download** one or more attachments from the provided URLs.

#### **Example Response**

```json filename="JSON"
{
  "error": "One or more attachments could not be downloaded.",
  "attachments": [
    {
      "statusCode": 403,
      "url": "http://example.com/kitten.png"
    }
  ]
}
```

ðŸ”¹ **Solution:**

- Ensure the **attachment URLs** are **publicly accessible** or use **authenticated result URLs**.
- Check for **broken links** or **expired URLs**.

---

### **Invalid Attachment Format**

ðŸ“Œ **Cause:** The attachment **could not be processed** due to **formatting issues**.

#### **Example Response**

```json filename="JSON"
{
  "error": "One or more attachments could not be downloaded.",
  "frames": [
    {
      "frame": 10,
      "message": "Invalid JSON Format: Unexpected end of JSON input",
      "attachment": {
        "statusCode": 200,
        "url": "http://example.com/lidar/frame10.json"
      }
    }
  ]
}
```

ðŸ”¹ **Solution:**

- Validate the JSON structure **before uploading**.
- Ensure all required fields are **correctly formatted**.

---

## **Best Practices for Handling API Errors**

âœ” **Implement Retry Logic**

- For **5xx errors (server issues)**, implement **exponential backoff** before retrying.
- Avoid retrying **4xx errors**, as they indicate **client-side issues**.

âœ” **Log API Responses**

- Capture and **log error responses** to help diagnose issues.

âœ” **Handle Missing Attachments Gracefully**

- If **attachments fail**, retry with **valid URLs** or **fall back to alternative data**.

âœ” **Monitor API Rate Limits**

- Avoid excessive requests to **prevent 429 errors** (Too Many Requests).
- Use **pagination** when retrieving large amounts of data.

âœ” **Secure API Keys**

- Never expose API keys **in public repositories**.
- Rotate API keys **if compromised**.

---

## **Summary**

| **Feature**                | **Details**                                                           |
| -------------------------- | --------------------------------------------------------------------- |
| **Common API Errors**      | **400** (Bad Request), **401** (Unauthorized), **500** (Server Error) |
| **Error Responses Format** | JSON responses with `status_code` and `error` message                 |
| **Attachment Errors**      | Failed downloads, incorrect formats, missing parameters               |
| **Best Practices**         | Implement retries, log errors, handle missing attachments             |

For more details, visit our **[API Documentation](https://api.skala.xyz/docs)** or contact **support@skala.xyz**.
